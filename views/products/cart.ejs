<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Shop</title>
    <link rel="stylesheet" type="text/css" href="/css/Style.css">
    <link href="https://fonts.googleapis.com/css?family=Poppins&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
</head>
<body>
    <a href="#" id="topBtn">
        <i class="fas fa-arrow-circle-up"></i>
    </a>
    <div class="header">
        <nav class="nav">
            <div class="logo">
                <h4>BOOK STORE</h4>
            </div>
            <ul class="nav-links">
                <li><a href="/">HOME <i class="fas fa-chevron-down"></i></a></li>
                <li><a href="">ABOUT <i class="fas fa-chevron-down"></i></a>
                    <ul class="child-links">
                        <li><a href="">ME</a></li>
                        <li><a href="">HISTORY</a></li>

                    </ul>

                </li>
                <li><a href="">USER <i class="fas fa-chevron-down"></i></a></li>
                <li><a href="/product/cart">CART <i class="fas fa-cart-plus"></i></a></li>
            </ul>
            <div class="burger">
                <div class="line1"></div>
                <div class="line2"></div>
                <div class="line3"></div>
            </div>
        </nav>
    </div>

    <div class="container " style="margin-top: 7%;">
        <div class="row">
            <div class="col-8" >
                <div class="row col-12">
                    <div class="detail-header col-12" style="margin: 1rem 0px;">
                        <a href="" class="Name-Product" style="font-size: 1.1rem">HOME</a> /
                        <a href="" class="Name-Product" style="font-size: 1.1rem">CART</a>
                    </div>
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th scope="col">Image</th>
                                <th scope="col">Name</th>
                                <th scope="col">Price</th>
                                <th scope="col">Amount</th>
                                <th scope="col" class="text-right">
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <% for(var i = 0; i< cartItems.length; i++) { %>
                            <tr>
                                <td>
                                    <img src=" <%= cartItems[i].ProImg %>" height="100" width="100" alt="">
                                </td>
                                <td>
                                    <h5>
                                        <%= cartItems[i].ProName %>
                                    </h5>
                                </td>
                                <td>
                                    <h5>
                                        <%= cartItems[i].ProCurrentPrice %>
                                    </h5>
                                </td>
                                <td class="text-center">
                                    <a href="/product/cart/add/<%= cartItems[i].ProId %>" style="color: rgb(230, 143, 29);" class="text-center Name-Product-1">
                                        <i class="fas fa-plus"></i>
                                    </a>
                                    <h5 class="">
                                        <%= cartItems[i].ProAmount %>
                                    </h5>
                                    <a href="/product/cart/sub/<%= cartItems[i].ProId %>" style="color: rgb(230, 143, 29);" class="Name-Product-1">
                                        <i class="fas fa-minus"></i>
                                    </a>
                                </td>
                                <td class="text-right">
                                    <a href="/product/cart/sub/<%= cartItems[i].ProId %>">
                                        <i class="fas fa-trash"></i>
                                    </a>
                                </td>
                            </tr>
                            <% } %>
                            <tr>
                                <td>
                                    <input class="input-code" type="text" name="code" id="txtCode" placeholder="Input Code">
                                </td>
                                <td colspan="3">
                                    <button onclick="return CheckCode();" class="btn btn-primary text-center" id="btnCheckCode">
                                        <i class="fas fa-check"></i> CHECK CODE
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

            </div>
            <div class="col-4">
                <div class="row cart">
                    <div class="col-12">
                        <h1 class="text-center text-white">Tổng cộng</h1>
                    </div>
                    <div class="col-12 ">
                        <label style="color: white;">Tiền sản phẩm:</label>
                        <label id="Total" style="color: rgb(255, 174, 0);"><%= formatPrice(total) %></label>
                    </div>  
                    <div class="col-12 ">
                        <label style="color: white;">Phí vận chuyển:</label>
                        <label style="color: rgb(255, 174, 0);">20,000</label>
                    </div>  
                    <div class="col-12">
                        <label style="color: white;">Tổng cộng:</label>
                        <label style="color: rgb(255, 174, 0);">520,000</label>
                    </div>
                    <div class="col-12 text-center" style="margin: 7% 0;">
                        <a href="/auth/payment" class="clean-btn">
                            THANH TOÁN
                        </a>
                    </div>  
                </div>

            </div>
        </div>

    </div>

    <footer>
        <div class=" footer" style="margin-top: 5rem;">
            <div class="row">
                <div class="col-4">
                    <h4 class="text-white text-center title-footer">Dịch vụ</h4>
                    <ul class="list-group list-group-flush list-footer">
                        <li class="list-group-item">
                            <a href="" class="Name-Product-1">Điều khoản sử dụng</a>
                        </li>
                        <li class="list-group-item">
                            <a href="" class="Name-Product-1">Chính sách bảo mật</a>
                        </li>
                        <li class="list-group-item">
                            <a href="" class="Name-Product-1">Giới thiệu</a>
                        </li>
                        <li class="list-group-item">
                            <a href="" class="Name-Product-1">Hệ thống trung tâm cửa hàng</a>
                        </li>
                    </ul>
                </div>
                <div class="col-4">
                    <h4 class="text-white text-center title-footer" >Hỗ trợ</h4>
                    <ul class="list-group list-group-flush list-footer">
                        <li class="list-group-item">
                            <a href="" class="Name-Product-1">Chính sách khuyến mãi</a>
                        </li>
                        <li class="list-group-item">
                            <a href="" class="Name-Product-1">Phương thức thanh toán</a>
                        </li>
                        <li class="list-group-item">
                            <a href="" class="Name-Product-1">Phương thức vận chuyển</a>
                        </li>
                        <li class="list-group-item">
                            <a href="" class="Name-Product-1">Chính sách đổi trả</a>
                        </li>
                    </ul>
                </div>
                <div class="col-4">
                    <h4 class="text-white text-center title-footer">Liên hệ</h4>
                    <ul class="list-group list-group-flush list-footer">
                        <li class="list-group-item">
                            <i class="fas fa-map-marker-alt"></i>
                            <p>Địa chỉ: 595 CMT8 Phường 12 Quận 5 TPHCM</p>
                        </li>
                        <li class="list-group-item">
                            <i class="far fa-envelope"></i>
                            <p>1612694@student.hcmus.edu.vn</p>
                        </li>
                        <li class="list-group-item">
                            <i class="fas fa-phone"></i>
                            <p>0123456789</p>
                        </li>
                    </ul>
                </div>
                <div class="col-6">
                    <div class="quote-primary">
                        <img src="/images/logo.jpg" class="logo-footer" alt="">
                    </div>
                </div>
                <div class="col-6">
                    <h4 class="text-white text-center title-footer">Follow us</h4>
                    <div class="text-center">
                        <a href="" class="icon-footer">
                            <i class="fab fa-facebook"></i>
                        </a>
                        <a href="" class="icon-footer">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="" class="icon-footer">
                            <i class="fab fa-twitter"></i>
                        </a>
                        <a href="" class="icon-footer">
                            <i class="fab fa-google-plus-g"></i>
                        </a>
                    </div>
                    <p class="text-white">Lorem ipsum dolor sit, amet consectetur adipisicing elit. Voluptatum enim iusto laudantium sed officiis pariatur facilis repellendus doloribus omnis consequuntur cupiditate quas minus doloremque nihil perferendis libero qui, quae magni.</p>
                </div>
            </div>
        </div>
    </footer>
    <script src="/js/nav.js"></script>
    <script>
        $(document).ready(function(){

            $(window).scroll(function(){
                if($(this).scrollTop() > 40) 
                {
                    $("#topBtn").fadeIn();
                }else
                {
                    $("#topBtn").fadeOut();
                }
            });

            $("#topBtn").click(function(){
                $("html,body").animate({scrollTop: 0},800);
            });
        })

        // Chưa formatPrice() được
        function ChangeTotalPrice(total) {
            console.log(total);
            $("#Total").html(total.toString());
            // document.getElementById("Total").innerHTML = formatPrice(total);
        }

        function CheckCode() {
            var code = $('#txtCode').val();
            $.ajax({
                url: '/product/check-code',
                method: 'POST',
                dataType: 'json',
                data: JSON.stringify({
                    code: $('#txtCode').val(),
                    total: <%= total %>

                }),
                contentType: 'application/json',
                cache: false,
                timeout: 5000,
                success: (total) => {
                    console.log('POST successfully!');
                    ChangeTotalPrice(total);
                },
                error: (error) => {
                    console.log('Error occured when POST');
                }
            });
            return false;
        }
        
    </script>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
</body>
</html>